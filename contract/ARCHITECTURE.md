# ğŸ—ï¸ Vault System Architecture

## Complete Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DEPLOYMENT SCRIPT                            â”‚
â”‚                   (DeployVaults.s.sol)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”œâ”€â”€â”€ STEP 1: Deploy Tokens
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  USDT  â”‚            â”‚  USDC  â”‚            â”‚  DAI   â”‚
   â”‚ Token  â”‚            â”‚ Token  â”‚            â”‚ Token  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â”‚ Mint 1M             â”‚ Mint 1M             â”‚ Mint 1M
        â–¼                     â–¼                     â–¼
   [Deployer]            [Deployer]            [Deployer]
   900K left             900K left             900K left
        â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”œâ”€â”€â”€ STEP 2: Deploy Vaults
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USDT Vault   â”‚      â”‚ USDC Vault   â”‚      â”‚ DAI Vault    â”‚
â”‚ (18% APY)    â”‚      â”‚ (12% APY)    â”‚      â”‚ (15% APY)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rewards: 95K â”‚      â”‚ Rewards: 95K â”‚      â”‚ Rewards: 95K â”‚
â”‚ (after fee)  â”‚      â”‚ (after fee)  â”‚      â”‚ (after fee)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  VaultFactory    â”‚
                    â”‚  (Pre-deployed)  â”‚
                    â”‚  Fee: 5%         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Details

### 1. Tokens (MockERC20)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USDT Token             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name: Tether USD           â”‚
â”‚ Symbol: USDT               â”‚
â”‚ Decimals: 18               â”‚
â”‚ Total Supply: 1,000,000    â”‚
â”‚                            â”‚
â”‚ Holder: Deployer (900K)    â”‚
â”‚ Vault: USDT Vault (100K)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USDC Token             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name: USD Coin             â”‚
â”‚ Symbol: USDC               â”‚
â”‚ Decimals: 18               â”‚
â”‚ Total Supply: 1,000,000    â”‚
â”‚                            â”‚
â”‚ Holder: Deployer (900K)    â”‚
â”‚ Vault: USDC Vault (100K)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     DAI Token              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name: Dai Stablecoin       â”‚
â”‚ Symbol: DAI                â”‚
â”‚ Decimals: 18               â”‚
â”‚ Total Supply: 1,000,000    â”‚
â”‚                            â”‚
â”‚ Holder: Deployer (900K)    â”‚
â”‚ Vault: DAI Vault (100K)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Vaults (RewardVault)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USDT Vault (hyUSDT)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Asset: USDT Token                    â”‚
â”‚ APY: 18% (1800 basis points)         â”‚
â”‚ Owner: Deployer                      â”‚
â”‚                                      â”‚
â”‚ Rewards Pool: 95,000 USDT            â”‚
â”‚ (100K - 5% factory fee)              â”‚
â”‚                                      â”‚
â”‚ Min Deposit: 100 USDT                â”‚
â”‚ Max Deposit: 100,000 USDT/user       â”‚
â”‚                                      â”‚
â”‚ Features:                            â”‚
â”‚ - Real-time APY (per second)         â”‚
â”‚ - Instant deposits/withdrawals       â”‚
â”‚ - Claim rewards anytime              â”‚
â”‚ - Pausable by owner                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USDC Vault (sUSDC)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Asset: USDC Token                    â”‚
â”‚ APY: 12% (1200 basis points)         â”‚
â”‚ Owner: Deployer                      â”‚
â”‚                                      â”‚
â”‚ Rewards Pool: 95,000 USDC            â”‚
â”‚ (100K - 5% factory fee)              â”‚
â”‚                                      â”‚
â”‚ Min Deposit: 100 USDC                â”‚
â”‚ Max Deposit: 100,000 USDC/user       â”‚
â”‚                                      â”‚
â”‚ Features:                            â”‚
â”‚ - Real-time APY (per second)         â”‚
â”‚ - Instant deposits/withdrawals       â”‚
â”‚ - Claim rewards anytime              â”‚
â”‚ - Pausable by owner                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     DAI Vault (opDAI)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Asset: DAI Token                     â”‚
â”‚ APY: 15% (1500 basis points)         â”‚
â”‚ Owner: Deployer                      â”‚
â”‚                                      â”‚
â”‚ Rewards Pool: 95,000 DAI             â”‚
â”‚ (100K - 5% factory fee)              â”‚
â”‚                                      â”‚
â”‚ Min Deposit: 100 DAI                 â”‚
â”‚ Max Deposit: 100,000 DAI/user        â”‚
â”‚                                      â”‚
â”‚ Features:                            â”‚
â”‚ - Real-time APY (per second)         â”‚
â”‚ - Instant deposits/withdrawals       â”‚
â”‚ - Claim rewards anytime              â”‚
â”‚ - Pausable by owner                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. VaultFactory (Pre-deployed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         VaultFactory                     â”‚
â”‚  0x29021eaeb230bc84120c0f05fdd83c446... â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Factory Owner: Original Deployer         â”‚
â”‚ Factory Fee: 500 bps (5%)                â”‚
â”‚ Fee Recipient: Factory Owner             â”‚
â”‚                                          â”‚
â”‚ Total Vaults: 3 (after deployment)       â”‚
â”‚                                          â”‚
â”‚ Functions Used:                          â”‚
â”‚ - createVault() â†’ Deploy new vaults      â”‚
â”‚ - getTotalVaults() â†’ Query count         â”‚
â”‚ - getVaultDetails() â†’ Query info         â”‚
â”‚ - isVault() â†’ Verify registration        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## User Interaction Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 1. Approve vault to spend tokens
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Token   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Contract â”‚         â”‚ Approval granted
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                     â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  Vault  â”‚
                â”‚Contract â”‚
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                     â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚               â”‚               â”‚
     â–¼               â–¼               â–¼
  Deposit        Withdraw        Claim
  Tokens         Tokens         Rewards
     â”‚               â”‚               â”‚
     â–¼               â–¼               â–¼
Receive         Get back        Receive
Shares          Principal       Earned
(1:1)           + Shares        Rewards
```

## Detailed User Flow Example

### Deposit Flow

```
1. User has 1,000 USDT
   â”‚
   â”œâ”€â–º Approves USDT Vault to spend 1,000 USDT
   â”‚
   â”œâ”€â–º Calls vault.deposit(1000 * 1e18)
   â”‚
   â”œâ”€â–º Vault transfers 1,000 USDT from user
   â”‚
   â”œâ”€â–º Vault mints 1,000 hyUSDT shares to user
   â”‚
   â””â”€â–º Rewards start accruing immediately
       (18% APY, calculated per second)
```

### Rewards Accrual (Real-time)

```
Time: 0s
â”œâ”€ Deposit: 1,000 USDT
â”œâ”€ Shares: 1,000 hyUSDT
â””â”€ Pending Rewards: 0 USDT

Time: 60s (1 minute)
â”œâ”€ Deposit: 1,000 USDT
â”œâ”€ Shares: 1,000 hyUSDT
â””â”€ Pending Rewards: ~0.000342 USDT

Time: 3600s (1 hour)
â”œâ”€ Deposit: 1,000 USDT
â”œâ”€ Shares: 1,000 hyUSDT
â””â”€ Pending Rewards: ~0.0205 USDT

Time: 86400s (1 day)
â”œâ”€ Deposit: 1,000 USDT
â”œâ”€ Shares: 1,000 hyUSDT
â””â”€ Pending Rewards: ~0.493 USDT

Time: 2592000s (30 days)
â”œâ”€ Deposit: 1,000 USDT
â”œâ”€ Shares: 1,000 hyUSDT
â””â”€ Pending Rewards: ~15 USDT

Time: 31536000s (1 year)
â”œâ”€ Deposit: 1,000 USDT
â”œâ”€ Shares: 1,000 hyUSDT
â””â”€ Pending Rewards: ~180 USDT
```

### Withdrawal Flow

```
1. User has 1,000 USDT deposited + pending rewards
   â”‚
   â”œâ”€â–º Calls vault.withdraw(1000 * 1e18)
   â”‚
   â”œâ”€â–º Vault automatically claims pending rewards first
   â”‚
   â”œâ”€â–º User receives pending rewards (e.g., 0.5 USDT)
   â”‚
   â”œâ”€â–º Vault burns 1,000 hyUSDT shares
   â”‚
   â””â”€â–º User receives 1,000 USDT principal

       Total received: 1,000.5 USDT
```

## Factory Fee Flow

```
User deposits 100,000 tokens as initial rewards
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    VaultFactory          â”‚
â”‚                          â”‚
â”‚  Calculates fee:         â”‚
â”‚  100,000 Ã— 5% = 5,000    â”‚
â”‚                          â”‚
â”‚  Remaining: 95,000       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â–º 5,000 â†’ Fee Recipient
          â”‚
          â””â”€â–º 95,000 â†’ Vault Rewards Pool
```

## System Interactions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Read: getVaultInfo(), getUserInfo(), etc.
       â”‚ Write: deposit(), withdraw(), claimRewards()
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Smart Contracts              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ VaultFactory â”‚  â”‚ RewardVault  â”‚ â”‚
â”‚  â”‚              â”‚  â”‚   (USDT)     â”‚ â”‚
â”‚  â”‚ - Create     â”‚â—„â”€â”¤              â”‚ â”‚
â”‚  â”‚ - Track      â”‚  â”‚ - Deposit    â”‚ â”‚
â”‚  â”‚ - Query      â”‚  â”‚ - Withdraw   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ - Claim      â”‚ â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   MockERC20  â”‚  â”‚ RewardVault  â”‚ â”‚
â”‚  â”‚   (USDT)     â”‚  â”‚   (USDC)     â”‚ â”‚
â”‚  â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚ - Transfer   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ - Approve    â”‚  â”‚ RewardVault  â”‚ â”‚
â”‚  â”‚ - Balance    â”‚  â”‚   (DAI)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Hedera      â”‚
â”‚  Testnet     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Access Control              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ VaultFactory:                       â”‚
â”‚ â”œâ”€ Only factory owner can:          â”‚
â”‚ â”‚  - Update factory fee             â”‚
â”‚ â”‚  - Update fee recipient           â”‚
â”‚ â”‚  - Deactivate vaults              â”‚
â”‚ â”‚                                   â”‚
â”‚ â””â”€ Anyone can:                      â”‚
â”‚    - Create vaults (with tokens)    â”‚
â”‚    - Query vault info               â”‚
â”‚                                     â”‚
â”‚ RewardVault:                        â”‚
â”‚ â”œâ”€ Only vault owner can:            â”‚
â”‚ â”‚  - Update APY                     â”‚
â”‚ â”‚  - Update limits                  â”‚
â”‚ â”‚  - Pause/unpause                  â”‚
â”‚ â”‚  - Deposit more rewards           â”‚
â”‚ â”‚                                   â”‚
â”‚ â””â”€ Any user can:                    â”‚
â”‚    - Deposit tokens                 â”‚
â”‚    - Withdraw tokens                â”‚
â”‚    - Claim rewards                  â”‚
â”‚    - Query balances                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Gas Optimization

```
Deployment (one-time):
â”œâ”€ Deploy Token: ~800K gas
â”œâ”€ Mint Tokens: ~50K gas
â””â”€ Deploy Vault: ~2.5M gas

User Operations (recurring):
â”œâ”€ Approve: ~45K gas
â”œâ”€ Deposit: ~150K gas
â”œâ”€ Withdraw: ~180K gas (includes claim)
â”œâ”€ Claim Rewards: ~80K gas
â””â”€ View Functions: FREE (off-chain)
```

## Summary

This architecture provides:

âœ… **Modular Design**: Separate tokens and vaults
âœ… **Scalable**: Easy to add more vaults
âœ… **Secure**: Access control and pausability
âœ… **Efficient**: Optimized gas usage
âœ… **Transparent**: All data on-chain and queryable
âœ… **User-Friendly**: Simple deposit/withdraw/claim flow
âœ… **Real-time Rewards**: APY calculated every second
âœ… **Sustainable**: Rewards pool management
